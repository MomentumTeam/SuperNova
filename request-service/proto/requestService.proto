syntax = "proto3";
import "google/protobuf/any.proto";

package RequestService;

service RequestService {
    rpc CreateOGRequest(CreateOGRequestReq) returns (CreateOGRequest) {}
    rpc CreateRoleRequest(CreateRoleRequestReq) returns (CreateRoleRequest) {}
    rpc CreateEntityRequest(CreateEntityRequestReq) returns (CreateEntityRequest){}

    rpc GetRequestsByCommander(GetRequestsByPersonIdReq) returns (MultipleGeneralRequests){}
    rpc GetRequestsSubmittedBy(GetRequestsByPersonIdReq) returns (MultipleGeneralRequests){}
    rpc GetRequestById(GetRequestByIdReq) returns (GeneralRequest) {}
    rpc GetAllRequests(GetAllRequestsReq) returns (MultipleGeneralRequests){}

    rpc AssignRoleToEntityRequest(AssignRoleToEntityRequestReq) returns (AssignRoleToEntityRequest) {}

    rpc RenameOGRequest(RenameOGRequestReq) returns (RenameOGRequest) {}
    rpc RenameRoleRequest(RenameRoleRequestReq) returns (RenameRoleRequest) {}
    rpc EditEntityRequest(EditEntityRequestReq) returns (EditEntityRequest){}

    rpc DeleteOGRequest(DeleteOGRequestReq) returns (DeleteOGRequest){}
    rpc DeleteRoleRequest(DeleteRoleRequestReq) returns (DeleteRoleRequest){}

    rpc UpdateRequest(UpdateRequestReq) returns (GeneralRequest){}
    rpc DeleteRequest(DeleteRequestReq) returns (DeleteRequestRes){}
}

//Enums

enum Source{
    SOURCE_1 = 0;
    SOURCE_2 = 1;
}

enum RequestType {
    CREATE_OG = 0;
    CREATE_ROLE = 1;
    ASSIGN_ROLE_TO_ENTITY = 2;
    CREATE_ENTITY=3;
    RENAME_OG = 4;
    RENAME_ROLE = 5;
    EDIT_ENTITY = 6;
    DELETE_OG = 7;
    DELETE_ROLE = 8;
}

enum Decision{
    UNKNOWN = 0;
    APPROVED = 1;
    DENIED = 2;
}

enum Status{
    SUBMITTED = 0;
    APPROVED = 1;
    DENIED = 2;
    IN_PROGRESS = 3;
    DONE = 4;
}

enum Clearance{
    LEVEL_1=0;
    LEVEL_2=1;
    LEVEL_3=2;
    LEVEL_4=3;
    LEVEL_5=4;
    YELLOW=5;
}

enum RoleStatus{
    ENABLED=0;
    DISABLED=1;
}

enum Sex{
    MALE = 0;
    FEMALE = 1;
}

enum ServiceType{
    SOLDIER = 0;
    RESERVED = 1;
    CIVILIAN = 2;
}

enum EntityType{
    SOLDIER = 0;
    RESERVED = 1;
    CIVILIAN = 2;
}

enum OGStatus{
    ACTIVE = 0;
    IN_ACTIVE = 1;
}

//Reqs

message UpdateRequestReq{
    string id = 1;
    GeneralRequest requestProperties = 2;
}

message OrganizationGroupMin{
    string id = 1;
    string hierarchy = 2;
    string name = 3;
    Group parent = 4;
}

message OrganizationGroup{
    string id = 1;
    string hierarchy = 2;
    string name = 3;
    Group parent = 4;

    Source source = 5;
    repeated string ancestors = 6;
    OGStatus status = 7;
    bool isLeaf = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10;
    repeated Entity directEntities = 11;
    repeated Role directRoles = 12;
}

message RoleMin{
    string roleId = 1;
    string jobTitle = 2;
    string digitalIdentityUniqueId = 3;
    Source source = 4;
}

message Role{
    string roleId = 1;
    string jobTitle = 2;
    string digitalIdentityUniqueId = 3;

    string directGroup = 4;
    string hierarchy = 5;
    repeated string hierarchyIds = 6;
    Source source = 7;
    int64 createdAt = 8;
    int64 updatedAt = 9;
}

message EntityMin{
    string id = 1;
    required string firstName = 2;
    string lastName = 3;
    required string identityCard = 4;
    string personalNumber = 5;
    ServiceType serviceType = 6;
    repeated string phone = 7;
    repeated string mobilePhone = 8;
    string address = 9;
    Sex sex = 10;
    int64 birthdate = 11;
    EntityType entityType = 12;
    Clearance clearance = 13;
}

message Entity{
    string id = 1;
    required string firstName = 2;
    string lastName = 3;
    required string identityCard = 4;
    string personalNumber = 5;
    ServiceType serviceType = 6;
    repeated string phone = 7;
    repeated string mobilePhone = 8;
    string address = 9;
    Sex sex = 10;
    int64 birthdate = 11;
    EntityType entityType = 12;
    Clearance clearance = 13;

    string displayName = 14;
    string directGroup = 15;
    string hierarchy = 16;
    string akaUnit = 17;
    int64 dischargeDate = 18;
    string rank = 19;
    string mail = 20;
    string jobTitle = 21;
    int64 createdAt = 22;
    int64 updatedAt = 23;
    repeated DigitalIdentity digitalIdentities = 24;
}

message DigitalIdentityMin{
    string uniqueId = 1;
}


message DigitalIdentity{
    string uniqueId = 1;

    string type = 2;
    string source = 3;
    string mail = 4;
    string entityId = 5;
    int64 createdAt = 6;
    int64 updatedAt = 7;
    bool isRoleAttachable = 8;
    Role role = 9;
}

message MultipleGeneralRequests{
    repeated GeneralRequest requests = 1;
    int32 totalCount = 2;
}


message GetAllRequestsReq{
    int32 from = 2;
    int32 to = 3;
}


message GetRequestsByPersonIdReq{
    string id = 1;
    int32 from = 2;
    int32 to = 3;
}

message GetRequestByIdReq{
    string id = 1;
}

message ApproverDecision{
    string approverId = 1;
    Decision approverDecision = 2;
}

message BaseReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status = 6;
}

message CreateOGRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status = 6;

    OrganizationGroupMin ogProperties = 7;
    OrganizationGroup createdOG = 8;
}

message CreateRoleRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    RoleMin roleProperties = 7;
    OrganizationGroupMin ogProperties = 8;
    Role createdRole = 9;
    DigitalIdentity createdDI = 10;
}

message AssignRoleToEntityRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    EntityMin entity = 7;
    RoleMin role = 8;
    bool needToDisconnectDI = 9;
    DigitalIdentityMin digitalIdentityToDisconnect = 10;
}

message CreateEntityRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    EntityMin entityProperties = 7;
    Entity createdEntity = 8;
}

message RenameOGRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    OrganizationGroupMin organizationGroup = 7;
    string newName = 8;
}

message RenameRoleRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    RoleMin role = 7;
    string newJobTitle = 8;
}

message EditEntityRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status=6;

    EntityMin entityProperties = 7;
}

message DeleteOGRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status = 6; 
    
    OrganizationGroupMin organizationGroup = 7;
}

message DeleteRoleRequestReq{
    string submittedBy = 1;
    ApproverDecision commanderDecision = 2;
    ApproverDecision securityDecision = 3;
    repeated string commanders = 4;
    Source source = 5;
    Status status = 6; 

    RoleMin role = 7;
}

message DeleteRequestReq{
    string id = 1;
}


//Requests

message BaseRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 
}

message DeleteRequestRes{
    bool success = 1;
}

message DeleteRoleRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    RoleMin role = 11;
}

message DeleteOGRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 
    
    OrganizationGroupMin organizationGroup = 11;

}

message EditEntityRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    EntityMin entityProperties = 11; 
}

message RenameRoleRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    RoleMin role = 11;
    string newJobTitle = 12;
}

message RenameOGRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    OrganizationGroupMin organizationGroup = 11;
    string newName = 12;
}

message CreateEntityRequest{
    string id = 1;
    RequestType type = 2;
    string submittedBy = 3;
    ApproverDecision commanderDecision = 4;
    ApproverDecision securityDecision = 5;
    repeated string commanders = 6;
    Source source = 7;
    Status status = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    EntityMin entityProperties = 11;
    Entity createdEntity = 12;
}

message AssignRoleToEntityRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    EntityMin entity = 11;
    RoleMin role = 12;
    bool needToDisconnectDI = 13;
    DigitalIdentityMin digitalIdentityToDisconnect = 14;
}

message CreateOGRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10; 

    OrganizationGroupMin ogProperties = 11;
    OrganizationGroup createdOG = 12;
}

message CreateRoleRequest{
    string id = 1;
    string submittedBy = 2;
    ApproverDecision commanderDecision = 3;
    ApproverDecision securityDecision = 4;
    repeated string commanders = 5;
    Source source = 6;
    Status status = 7;
    RequestType type = 8;
    int64 createdAt = 9;
    int64 updatedAt = 10;

    RoleMin roleProperties = 11;
    OrganizationGroupMin ogProperties = 12;
    Role createdRole = 13;
    DigitalIdentity createdDI = 14;
}

message Group{
    string id = 1;
    string fullHierarchy = 2;
}

message GeneralRequest{
    optional string id = 1;
    optional RequestType type = 2;
    optional string submittedBy = 3;
    optional ApproverDecision commanderDecision = 4;
    optional ApproverDecision securityDecision = 5;
    repeated string commanders = 6;
    optional Source source = 7;
    optional Status status = 8;
    optional int64 createdAt = 9;
    optional int64 updatedAt = 10; 

    //createOGRequest
    optional OrganizationGroupMin ogProperties = 11;
    optional OrganizationGroup createdOG = 12;

    //createRoleRequest
    optional RoleMin roleProperties = 13;
    // OrganizationGroupMin ogProperties = 14;
    optional Role createdRole = 14;
    optional DigitalIdentity createdDI = 15;

    //assignRoleToEntityRequest
    optional EntityMin entity = 16;
    optional RoleMin role = 17;
    optional bool needToDisconnectDI = 18;
    optional DigitalIdentityMin digitalIdentityToDisconnect = 19;

    //createEntityRequest
    optional EntityMin entityProperties = 20;
    optional Entity createdEntity = 21;

    //renameOGRequest
    optional OrganizationGroupMin organizationGroup = 22;
    optional string newName = 23;

    //renameRoleRequest
    // RoleMin role = 11;
    optional string newJobTitle = 24;

    //EditEntityRequest
    // EntityMin entityProperties = 26; 
    
    //DeleteOGRequest      
    // OrganizationGroupMin organizationGroup = 11;

    //DeleteRoleRequest
    // RoleMin role = 11;

    //UpdateRequest
    optional GeneralRequest requestProperties = 25;
    
}